#setwd("~/Documents/CMEECourseWork/Week4/Code")
d<-read.table("../Data/SparrowSize.txt", header=TRUE)
d1<-subset(d,  d$Mass!="NA")
d2<-subset(d1,  d1$Tarsus!="NA")
length(d2$Tarsus)
model1<-lm(Mass~Tarsus, data=d2)
summary(model1)
hist(model1$residuals)
source('~/Documents/CMEECourseWork/Week4/Code/ho10.R')
source('~/Documents/CMEECourseWork/Week4/Code/ho10.R')
model2<-lm(y~x)
summary(model2)
#run model with z scores instead of tarsus
d2$z-Tarsus<-scale(d2$Tarsus)
#run model with z scores instead of tarsus
d2$z.Tarsus<-scale(d2$Tarsus)
model3<-lm(Mass~z.Tarsus,data=d2)
summary(model3)
plot(d2$Mass~ds$z.Tarsus, pch=19, cex=0.4)
plot(d2$Mass~d2$z.Tarsus, pch=19, cex=0.4)
abline(v=0, lty="dotted")
head(d)
str(d)
d$Sex<-as.numeric(d$Sex)
par(mfrow=c(1,2))
plot(d$Wing~d$Sex, xlab="Sex", ylab="Wing(mm)")
graphics.off()
par(mfrow=c(1,2))
plot(d$Wing~d$Sex, xlab="Sex", ylab="Wing(mm)",xlim=c(-0.1,1,1),ylab="")
plot(d$Wing~d$Sex.1, ylab="Wing(mm)")
plot(d$Wing~d$Sex, xlab="Sex",xlim=c(-0.1,1,1),ylab="")
plot(d$Wing~d$Sex, xlab="Sex",xlim=c(-0.1,1,1),ylab="")
graphics.off()
par(mfrow=c(1,2))
plot(d$Wing~d$Sex.1, ylab="Wing(mm)")
plot(d$Wing~d$Sex, xlab="Sex",xlim=c(-0.1,1,1),ylab="")
plot(d$Wing~d$Sex, xlab="Sex",xlim=c(-0.1,1.1),ylab="")
graphics.off()
d$Sex<-as.numeric(d$Sex)
par(mfrow=c(1,2))
plot(d$Wing~d$Sex.1, ylab="Wing(mm)")
plot(d$Wing~d$Sex, xlab="Sex",xlim=c(-0.1,1.1),ylab="")
abline(lm(d$Wing~d$Sex), lwd=2)
text(0.15,76,"intercept")
text(0.9,77.5,"slope", col="red")
t4
graphics.off()
par(mfrow=c(2,2))
plot(model3)
d4<-subset(d,d$Wing!="NA")
d4<-subset(d,d$Wing!="NA")
m4<-lm(Wing~Sex, data=d4)
t4<-t.test(d4$Wing~d4$Sex, var.equal=TRUE)
summary(m4)
t4
par(mfrow=c(2,2))
plot(model4)
plot(model3)
par(mfrow=c(2,2))
plot(m4)
##top left  -residuals-- random distribution is what we want
#qq plot should be straight line
d5<-subset(d1,d1$Bill!=NA)
##top left  -residuals-- random distribution is what we want
#qq plot should be straight line
d5<-subset(d1,d1$Bill!="NA")
model5<-lm(Mass~Bill, data=d5)
summary(model5)
plot(d5$MAss,d5$Bill)
plot(d5$Mass,d5$Bill)
source('~/Documents/CMEECourseWork/Week4/Code/ho10.R')
source('~/Documents/CMEECourseWork/Week4/Code/ho10.R')
source('~/Documents/CMEECourseWork/Week4/Code/ho15.R')
source('~/Documents/CMEECourseWork/Week4/Code/ho15.R')
source('~/Documents/CMEECourseWork/Week4/Code/ho15.R')
##looking for outliers
graphics.off()
par(mfrow=c(2,2))
boxplot(timber$volume)
boxplot(timber$girth)
boxplot(timber$height)
#can see one outlier. seem biologically true.better to keep stuff in
##looking for homogeneity of variaces
var(timber$volume)
var(timber$girth)
var(timber$height)
t2$z.girth<-scale(timber$girth)
t2$z.height<-scale(timber$height)
#not equal really
#so standardise x for analysis?
t2<-as.data.frame(subset(timber,timber$volume!="NA"))
t2$z.girth<-scale(timber$girth)
t2$z.height<-scale(timber$height)
var(t2$z.girth)
var(t2$z.height)
plot(t2)
plot(t)
plot(t2)
#are data normally distributed
par(mfrow=c(2,2))
#are data normally distributed
graphics.off()
par(mfrow=c(2,2))
hist(t2$volume)
hist(tw$girth)
hist(t2$girth)
hist(t2$he)
hist(t2$height)
#this is as good as it gets
#excessively many 0s?
#no
#collinearity between covariates
pairs(timber)
cor(timber)
#yeah , issue is inflates variation.
#so less likely t get signiicant result
summary(lm(girth~height, data = timber))
VIF<- 1/(1-0.27)
VIF
sqrt(VIF)
#so standard errors will be inflated by 1.17 which is ok .
#what is acceptable varies but testing for it and keep in mind and disclose
pairs(timber)
cor(timber)
pairs(t2)
pairs(t2)
cor(t2)
source('~/Documents/CMEECourseWork/Week4/Code/ho15.R')
#correlations are same which we want
#6. visually inspect relatinoshups
#7. consider interactinos
#model!
timberMod<-lm(volume~girth+height, data=timber)
anova(timberMod)
source('~/Documents/CMEECourseWork/Week4/Code/ho15.R')
summary(timberMod)
plot(timberMod)
#excercise 1
residuals$timberMod
#excercise 1
timberMod$residuals
timber$Resid>-resid(timberMod)
timber
#excercise 1
#timberMod$residuals
timber$Resid>-resid(timberMod)
#excercise 1
#timberMod$residuals
timber$Resid<-resid(timberMod)
timber
timberless<-timber[1:30,]
View(timberless)
timberlessMod<-lm(volume~girth+height, data=timberless)
anova(timberlessMod)
timberlessMod<-lm(volume~girth+height, data=timberless)
anova(timberlessMod)
summary(timberlessMod)
plot(timberlessMod)
plot(timberMod)
#both height and girth dignificant
summary(timberMod)
#results unchanged by removing outlier so would include outlier
plantGrowth  <-  read.delim("../Data/ipomopsis.txt")
summary(plantGrowth)
setwd("~/Documents/CMEECourseWork/Week4/Code")
setwd("~/Documents/CMEECourseWork/Week4/Code")
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: ho13.R
#Desc: anova
#Arguments: none
#Input: none
#Output: none
#Date: Oct 2019
d<-read.table("../Data/SparrowSize.txt",header=TRUE)
d1<-subset(d, d$Wing!="NA")
hist(d1$Wing)
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: ho13.R
#Desc: anova
#Arguments: none
#Input: none
#Output: none
#Date: Oct 2019
graphics.o
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: ho13.R
#Desc: anova
#Arguments: none
#Input: none
#Output: none
#Date: Oct 2019
graphics.off()
hist(d1$Wing)
model1<-lm(Wing ~ Sex.1, data=d1)
summary(model1)
boxplot(d1$Wing~d1$Sex.1, ylab="Wing length (mm)")
anova(model1)
##residual mean squares-->within group mean squares
t.test(d1$Wing~d1$Sex.1, var.equal=TRUE)
##boxplod for a bunch of years
boxplot(d1$Wing~d1$BirdID, ylab="WIng length (mm)")
require(dplyr)
tbl_df(d1)
glimpse(d1)
d$Mass  %>%  cor.test(d$Tarsus,  na.rm=TRUE)
d1  %>%
group_by(BirdID)  %>%
summarise  (count=length(BirdID))
d1  %>%
group_by(BirdID)  %>%
summarise  (count=length(BirdID))
count(d1,BirdID)
d1  %>%
group_by(BirdID)  %>%
summarise  (count=length(BirdID))    %>%
count(count)
count(d1,  d1$BirdID)  %>%
count(count)
model3<-lm(Wing~as.factor(BirdID),  data=d1)
anova(model3)
boxplot(d$Mass~d$Year)
m2<-lm(d$Mass~as.factor(d$Year))
anova(m2)
summary(m2)
t(model.matrix(m2))
d2<-subset(d1$Year!="2000")
d2
d2<-subset(d1,d1$Year!="2000")
d2
md2<-lm(d2$Mass~as.factor(d2$Year))
anova(md2)
summary(md2)
source("ho13.R")
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: ho18.R
#Desc:
#Arguments:
#Input:
#Output:
#Date: Oct 2019
a<-read.table("../ObserverRepeatability.txt", header = TRUE)
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: ho18.R
#Desc:
#Arguments:
#Input:
#Output:
#Date: Oct 2019
a<-read.table("../Data/ObserverRepeatability.txt", header = TRUE)
library(dplyr)
a  %>%
group_by(StudentID)  %>%
summarise  (count=length(StudentID))
a  %>%
group_by(StudentID)  %>%
summarise  (count=length(StudentID))    %>%
summarise  (length(StudentID
)
)
a  %>%
group_by(StudentID)  %>%
summarise  (count=length(StudentID))    %>%
summarise  (length(StudentID))
a  %>%
group_by(StudentID)  %>%
summarise  (count=length(StudentID))  %>%
summarise  (sum(count))
length(a$StudentID)
a  %>%
group_by(StudentID)  %>%
summarise  (count=length(StudentID))  %>%
summarise  (sum(count^2))
mod<-lm(Tarsus~StudentID,data=a)
anova(mod)
source('~/Documents/CMEECourseWork/Week4/Code/ho18.R')
mod<-lm(Tarsus~StudentID,data=a)
anova(mod)
source('~/Documents/CMEECourseWork/Week4/Code/ho18.R')
mod<-lm(Tarsus~Leg+Handedness+StudentID,data=a)
anova(mod)
require(lme4)
lmm<-lmer(Tarsus~Leg+Handedness+(1|StudentID),data=a)
install.packages("lme4")
#modelling studnet id as random effect
summary(lmm)
lmm<-lmer(Tarsus~Leg+Handedness+(1|StudentID),data=a)
#modelling studnet id as random effect
summary(lmm)
require(lme4)
lmm<-lmer(Tarsus~Leg+Handedness+(1|StudentID),data=a)
#modelling studnet id as random effect
summary(lmm)
source('~/Documents/CMEECourseWork/Week4/Code/ho18.R')
install.packages("lme4")
install.packages("lme4")
?lme4
?lmm
require(lme4)
install.packages("lme4")
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: nlss_excercises.R
#Desc: nlss
#Arguments:none
#Input: none
#Output: none
#Date: Oct 2019
rm(list = ls())
graphics.off()
setwd("~/Documents/CMEECourseWork/Miniproject/Sandbox")
library(repr)
library(repr)
install.packages("repr")
library(repr)
install.packages("minpack.lm")
return(a * x^b)
powMod<- function(x, a, b) {
return(a * x^b)
}
MyData<-read.csv("../Data/GenomeSize.csv")
head(MyData)
Data2Fit<- subset(MyData, Suborder == "Anisoptera")
Data2Fit<-Data2Fit[!is.na(Data2Fit$TotalLength),]
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
library("ggplot2")
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight))+
geom_point(size = (3), color="red") + theme_bw()+
labs(y="Body mass (mg)", x = "Wing length (mm)")
PowFit<- nlsLM(BodyWeight ~ powMod(TotalLength, a , b), data= Data2Fit, start= list(a = .1, b = .1))
?nlsLM
??nlsLM
install.packages("minpack.lm")
library("minpack.lm")
PowFit<- nlsLM(BodyWeight ~ powMod(TotalLength, a , b), data= Data2Fit, start= list(a = .1, b = .1))
>nls.lm()
?nlsLM
library("minpack.lm")
powMod<- function(x, a, b) {
return(a * x^b)
}
?nlsLM
PowFit<- nlsLM(BodyWeight ~ powMod(TotalLength, a , b), data= Data2Fit, start= list(a = .1, b = .1))
?nlsLM
?nlsLM
remove.packages("minpack.lm");install.packages("minpack.lm")
install.packages("minpack.lm")
library(minpack.lm)
?nls.lm
PowFit<- nlsLM(BodyWeight ~ powMod(TotalLength, a , b), data= Data2Fit, start= list(a = .1, b = .1))
?nlsLM
summary(PowFit)
anova(PowFit)
Lengths<- seq(min(Data2Fit$TotalLength), max(Data2Fit$TotalLength), len=200)
Lengths
coef(PowFit)["a"]
coef(PowFit)["b"]
coef(PowFit)
Predic2PlotPow<-powMod(Lengths,coef(PowFit)["a"], coef(PowFit)["b"])
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col="blue", lwd=2.5)
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col="blue", lwd=2.5)
graphics.off()
Predic2PlotPow<-powMod(Lengths,coef(PowFit)["a"], coef(PowFit)["b"])
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col="blue", lwd=2.5)
confint(PowFit)
QuaFit<- lm(BodyWeight ~ poly(TotalLength,2), data= Data2Fit)
install.packages("lme4")
Predic2PlotQua<-predict.lm(QuaFit, data.frame(TotalLength=Lengths))
plot(Data2Fit$TotalLength,Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col="blue", lwd=2.5)
lines(Lengths, Predic2PlotQua, col="red", lwd=2.5)
#formal comparison
RSS_Pow<- sum(residuals(PowFit)^2)
TSS_Pow<-sum(Data2Fit$BodyWeight - mean(Data2Fit$BodyWeight))^2)
TSS_Pow<-sum((Data2Fit$BodyWeight - mean(Data2Fit$BodyWeight))^2)
RSq_Pow<-1- (RSS_Pow/TSS_Pow)
RSS_Qua<- sum(residuals(QuaFit)^2)
TSS_Qua<-sum((Data2Fit$BodyWeight- mean(Data2Fit$BodyWeight))^2)
RSq_Qua<-1-(RSS_Qua/TTSS_Qua)
RSq_Qua<-1-(RSS_Qua/TSS_Qua)
RSq_Pow
RSq_Qua
n<- nrow(Data2Fit)
pPow<-length(coef(PowFit))
pQua<-length(coef(QuaFit))
AIC_Pow <- n + 2 + n * log((2 * pi) / n) +  n * log(RSS_Pow) + 2 * pPow
AIC_Qua <- n + 2 + n * log((2 * pi) / n) + n * log(RSS_Qua) + 2 * pQua
AIC_Pow - AIC_Qua
AIC(PowFit)-AIC(QuaFit)
BIC(PowFit)-BIC(QuaFit)
BIC(PowFit)-BIC(QuaFit)
LinFitQuaFit <- lm(BodyWeight ~ TotalLength, data = Data2Fit)
LinFit <- lm(BodyWeight ~ TotalLength, data = Data2Fit)
Predic2Lin <- predict.lm(LinFit, data.frame(TotalLength = Lengths))
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
lines(Lengths, Predic2Lin, col = 'green', lwd = 2.5)
lines(Lengths, Predic2Lin, col = 'green', lwd = 2.5)
lines(Lengths, Predic2PlotQua, col = 'red', lwd = 2.5)
##albatross chick
alb<- read.csv(file-"../Data/albatross_grow.csv")
alb<- subset(x=alb, !is.na(alb$wt))
plot(alb$age, alb$wt, xlab="age (days)", ylab="weight (g)", xlim=c(0,100))
alb<- subset(x=alb, !is.na(alb$wt))
plot(alb$age, alb$wt, xlab="age (days)", ylab="weight (g)", xlim=c(0,100))
##albatross chick
alb<- read.csv(file-"../Data/albatross_grow.csv")
alb<- subset(x=alb, !is.na(alb$wt))
plot(alb$age, alb$wt, xlab="age (days)", ylab="weight (g)", xlim=c(0,100))
install.packages("lme4")
install.packages("lme4")
setwd("~/Documents/CMEECourseWork/Week5/Code")
Rodents<-read.csv("../Data/rodents.csv")
View(Rodents)
?barplot
barplot(hfl)
barplot(hfl, data=Rodents)
library(ggplot2)
ggplot(Rodents,aes(wgt,hfl)
ggplot(Rodents,aes(wgt,hfl))
library(ggplot2)
ggplot(Rodents,aes(wgt,hfl))
ggplot(Rodents,aes(wgt,hfl))+geom_point()
na.omit(Rodents)
#Author: Ruth Keane (ruth.keane19@imperial.ac.uk)
#Script: Rodents.R
#Desc:
#Arguments:
#Input:
#Output:
#Date: Oct 2019
Rodents<-read.csv("../Data/rodents.csv")
ggplot(Rodents,aes(wgt,hfl, colour=sex))+geom_point()
na.omit(Rodents)
ggplot(Rodents,aes(wgt,hfl, colour=))+geom_point()
ggplot(Rodents,aes(wgt,hfl, colour=))+geom_point()
ggplot(Rodents,aes(wgt,hfl, colour=sex))+geom_point()
ggplot(Rodents,aes(wgt,hfl, colour=yr))+geom_point()
ggplot(Rodents,aes(wgt,hfl, colour=yr))+geom_point()
ggplot(Rodents,aes(hfl,wgt, colour=yr))+geom_point()
ggplot(Rodents,aes(hfl,wgt, colour=precip))+geom_point()
ggplot(Rodents,aes(hfl,wgt, colour=mo))+geom_point()
ggplot(Rodents,aes(hfl,wgt, colour=species))+geom_point()
Do<-subset(Rodents,species="DO")
ggplot(DO,aes(hfl,wgt, colour=species))+geom_point()
ggplot(Do,aes(hfl,wgt, colour=species))+geom_point()
Do<-subset(Rodents,species!="DO")
ggplot(Do,aes(hfl,wgt, colour=species))+geom_point()
Ds<-subset(Rodents,species!="DS")
ggplot(Ds,aes(hfl,wgt, colour=species))+geom_point()
barplot(Ds)
barplot(Ds,hfl)
?barplot
na.omit(height,data=Ds)
na.omit(hfl,data=Ds)
histogram(hfl, data=Ds)
hist(hfl, data=Ds)
Dx<-subset(Rodents,species=="DX")
#library(ggplot2)
ggplot(Dx,aes(hfl,wgt, colour=sex))+geom_point()
#library(ggplot2)
ggplot(DX,aes(hfl,wgt, colour=sex))+geom_point()
DX<-subset(Rodents,species=="DX")
#library(ggplot2)
ggplot(DX,aes(hfl,wgt, colour=sex))+geom_point()
DS<-subset(Rodents,species=="DS")
#library(ggplot2)
ggplot(DX,aes(hfl,wgt, colour=sex))+geom_point()
#library(ggplot2)
ggplot(DS,aes(hfl,wgt, colour=sex))+geom_point()
#library(ggplot2)
ggplot(DS,aes(hfl,wgt, colour=yr))+geom_point()
#library(ggplot2)
ggplot(DS,aes(hfl,wgt, colour=sex))+geom_point()
DS<-na.rm(DS)
DS<-omit.na(DS)
DS<-na.omit(DS)
View(DS)
View(DS)
DSSub<-subset(DS,sex!="")
Rodents<-read.csv("../Data/rodents.csv")
DS<-subset(Rodents,species=="DS")
DSSub<-subset(DS,sex!="")
DSSub<-subset(DSSub,yr!="NA")
DSSub<-subset(DSSub,hfl!="NA")
#library(ggplot2)
View(DSSub)
View(DSSub)
?lm
lm(wgt,hfl*sex+(1|yr)+(1|mo))
lm(wgt,hfl*sex+(1|yr)+(1|mo), data=DSSub)
lm(wgt~hfl*sex+(1|yr)+(1|mo), data=DSSub)
MOD<-lm(wgt~hfl*sex+(1|yr)+(1|mo), data=DSSub)
summary(MOD)
shapiro.test(MOD$residuals)
MOD<-lmer(wgt~hfl*sex+(1|yr)+(1|mo), data=DSSub)
install.packages(lme4)
install.packages("lme4")
library(lme4)
install.packages("lme4")
require(lme4)
install.packages("lme4")
install.packages(c("BiocManager", "digest", "jpeg", "rlang"))
install.packages(c("BiocManager", "digest", "jpeg", "rlang"))
install.packages(c("BiocManager", "digest", "jpeg", "rlang"))
install.packages(c("BiocManager", "digest", "jpeg", "rlang"))
install.packages(c("BiocManager", "digest", "jpeg", "rlang"))
require(lme4)
install.packages("lme4")
install.packages("lme4")
require(lme4)
