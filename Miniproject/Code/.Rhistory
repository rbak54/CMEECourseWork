par(mfrow=c(3,1))
a<-lm(log(data1$aI)~data1$ConTemp)
##what des this meannnnnnnnn.
plot(data1$ConTemp,log(data1$aI))
plot(data1$ConTemp,sqrt(a$residuals^2))
plot(data1$ConTemp,a$residuals)
#this graph shows that mechanistic is slightly better
modelbesttype<-  ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
modelbesttyperecal<-  ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#type 2 most common then 1 then 3
modelbest<-ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,75)+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
modelbesttyperecal<-  ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#this graph shows that mechanistic is slightly better
modelbesttype<-  ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim=(0,150)+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim=c(0,150)+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim=c(0,150)+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim=(0,150)+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim=(0,150)+scale_fill_colorblind("Best Model")
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#modelbesttyperecal<-
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,150)+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,150)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,150)+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,150)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#type 2 most common then 1 then 3
modelbest<-ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,75)+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
modelsecondbest<-ggplot(data=data, aes(BestAIC_sec))+geom_bar()+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
printgraph(modelbesttype)
printgraph(modelbestholl)
printgraph(modelbesthollrecal)
printgraph(modelbest)
printgraph(modelsecondbest)
printgraph(modelbesttyperecal)
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#type 2 most common then 1 then 3
modelbest<-ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,75)+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
modelsecondbest<-ggplot(data=data, aes(BestAIC_sec))+geom_bar()+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
printgraph(modelbesttype)
printgraph(modelbestholl)
printgraph(modelbesthollrecal)
printgraph(modelbest)
printgraph(modelsecondbest)
printgraph(modelbesttyperecal)
##section3?
sum(data$BestAICHol=="HollingIII_AIC")
sum(data$BestAICHolRECAL=="HollingIII_AIC")
##section3?
sum(data$BestAICHol=="HollingIII_AIC")-
sum(data$BestAICHolRECAL=="HollingIII_AIC")
a<-lm(dataset_aii$ConTemp~log(dataset_aii$aII))
shapiro.test(a$residuals)
dataset_aiii<-subset(data3, !is.na(ConTemp) & !is.na(aIII))
a<-lm(dataset_aiii$ConTemp~log(dataset_aiii$aIII))
shapiro.test(a$residuals)
dataset_ai<-subset(data1,!is.na(ConTemp) &  aI>0)
a<-lm(dataset_ai$ConTemp~log(dataset_ai$aI))
shapiro.test(a$residuals)
dataset_hiii<-subset(data3h, !is.na(ConTemp) & !is.na(hIII))
dataset_hii<-subset(data2, !is.na(ConTemp) &!is.na(hII))
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s")
n<-vector(length=4)
con_search_1<-cor.test(dataset_ai$ConTemp,dataset_ai$aI,method = "k")
n[1]<-nrow(dataset_ai)
con_search_2<-cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "k")
n[2]<-nrow(dataset_aii)
con_search_3<-cor.test(dataset_aiii$ConTemp,dataset_aiii$aIII,method = "k")
#not poss for aiii- only 20 where significant
con_hand_2<-cor.test(dataset_hii$ConTemp,dataset_hii$hII,method = "k")
n[3]<-nrow(dataset_hii)
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s",correct=F)
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s",correct=F)
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s",correct=FALSE)
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s")
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "k")
data$CUTCONTEMP<-NA
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,25,40))
variable<-"CUTCONTEMP"
data$CUTRESTEMP<-NA
data$CUTRESTEMP<-cut(data$ResTemp,c(0,15,25,40))
variable<-"CUTRESTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected
data$CUTCONTEMP<-NA
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,25,40))
variable<-"CUTCONTEMP"
data$CUTRESTEMP<-NA
data$CUTRESTEMP<-cut(data$ResTemp,c(0,15,25,40))
variable<-"CUTRESTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
data$CUTCONTEMP<-NA
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,25,40))
variable<-"CUTCONTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,30,35,40))
variable<-"CUTCONTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,30,40))
variable<-"CUTCONTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,40))
variable<-"CUTCONTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,25,40))
variable<-"CUTCONTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,df)
chisquared
ggplot(data=data,aes(CUTCONTEMP,BestAIC)
ggplot(data=data,aes(CUTCONTEMP,BestAIC)+geom_bar()
library(ggplot2)
ggplot(data=data,aes(CUTCONTEMP,BestAIC)+geom_bar()
ggplot(data=data,aes(CUTCONTEMP,BestAIC))+geom_bar()
library(xtable)
options(xtable.floating = FALSE)
#options(xtable.timestamp = "")
library(ggplot2)
data<-read.csv("../Results/CRatmodelfitting.csv")
if (dir.exists("../Results/Tables")==FALSE){
dir.create("../Results/Tables")
}
#add to python some of these
data$BestAIC<-NA
data$BestAICHolRECAL<-NA
data$BestAICHol<-NA
data$qcil<-NA
data$qciu<-NA
data$qIIIci<-NA
data$qcil<-data$qIII-2*data$qse
data$qciu<-data$qIII+2*data$qse
data$best.model.type<-NA
data$Con_ForagingMovement<-tolower(data$Con_ForagingMovement)
#best AIC
ltHol<-as.vector(match("HollingI_AIC",names(data)):match("HollingIII_AIC",names(data)))
ltHolR<-as.vector(match("HollingI_AIC",names(data)):match("HollingII_AIC",names(data)))
lt2<-as.vector(match("HollingI_AIC",names(data)):match("Poly3_AIC",names(data)))
lt<-c(match("HollingI_AIC",names(data)):match("HollingII_AIC",names(data)),match("Poly2_AIC",names(data)):match("Poly3_AIC",names(data)))
for ( i in 1:nrow(data)){
data$BestAIC[i]<-colnames(sort(data[i,lt2],decreasing = F)[1])
#best of hollings
data$BestAICHol[i]<-colnames(sort(data[i,ltHol],decreasing = F)[1])
#second best model
data$BestAIC_sec[i]<-colnames(sort(data[i,lt2],decreasing = F)[2])
#here when recalculate if ci overlap 0 for gen holII--> recalculate best model and best holling model
data$BestAICRECAL[i]<-ifelse(!is.na(data$qIII[i]) & (with(data, qcil[i] < 0 & qciu[i]> 0)),colnames(sort(data[i,lt],decreasing = F)[1]),colnames(sort(data[i,lt2],decreasing = F)[1]))
data$BestAICHolRECAL[i]<-ifelse(!is.na(data$qIII[i]) & (with(data, qcil[i] < 0 & qciu[i]> 0)),colnames(sort(data[i,ltHolR],decreasing = F)[1]),colnames(sort(data[i,ltHol],decreasing = F)[1]) )
data$qIIIci[i]<-ifelse(!is.na(data$qIII[i]) & (with(data, qcil[i] < 0 & qciu[i]> 0)),0,data$qIII[i])
}
#is the best model mechanistic or phenomomenological
data$best.model.type <- ifelse(data$BestAIC == "HollingI_AIC" | data$BestAIC== "HollingII_AIC" | data$BestAIC=="HollingIII_AIC", 'Mechanistic',
ifelse(data$BestAIC == "Poly2_AIC" | data$BestAIC == "Poly3_AIC", 'Phenomenological', 'No_successful_model'))
data$best.model.type.recal <- ifelse(data$BestAICRECAL == "HollingI_AIC" | data$BestAICRECAL== "HollingII_AIC" | data$BestAICRECAL=="HollingIII_AIC", 'Mechanistic',
ifelse(data$BestAICRECAL == "Poly2_AIC" | data$BestAICRECAL == "Poly3_AIC", 'Phenomenological', 'No_successful_model'))
#this graph shows that mechanistic is slightly better
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")
#but this changes if recal
ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")
# for formatting http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization
#hist(data$qIIIci,breaks = 30)
#diff between holling and holling recal
ggplot(data=data, aes(BestAICHol))+geom_bar()+ylim(0,200)
ggplot(data=data, aes(BestAICHolRECAL))+geom_bar()+ylim(c(0,200))
#type 2 most common then 1 then 3
ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,200)
ggplot(data=data,aes(x=BestAIC,fill=as.factor(Res_ForagingMovement)))+geom_bar(stat="count")
ggplot(data=data,aes(x=BestAIC,fill=as.factor(Con_ForagingMovement)))+geom_bar(stat="count")
#see messing for genus stuff
chitable<-matrix(nrow=2,ncol=2)
#chi squared goodness of fit
##stats to say different
Expected<-rep(0.2*nrow(data),5)
Observed<-unname(table(data$BestAIC))
chisquared<-sum(((Observed-Expected)^2)/Expected)
chitable[1,1]<-chisquared
chitable[1,2]<-1-pchisq(chisquared,4)
#so reject the null hypothesis that all models are as good as each other
Expected<-rep(0.5*nrow(data),2)
Observed<-unname(table(data$best.model.type))
chisquared<-sum(((Observed-Expected)^2)/Expected)
chitable[2,1]<-chisquared
chitable[2,2]<-1-pchisq(chisquared,1)
colnames(chitable)<-c("Chi-squared","p-value")
rownames(chitable)<-c("Best Model","Best Model Type")
output_chitable<-xtable(chitable,label='chitable',caption = 'Results of chi-squared goodness of fit tests for whether the best model and the best model type (i.e phenomenological or mechanistic) are uniformally distributed')
print(output_chitable,floating=FALSE,tabular.environment = 'longtable',file ="../Results/Tables/output_chitable_latex.txt",caption.placement ="top")
#TPYE NOT SIGNIFICANT DIFFERENCE not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHolRECAL)),3)
Observed<-unname(table(data$BestAICHolRECAL))
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,2)
data$CUTCONTEMP<-NA
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,25,40))
variable<-"CUTCONTEMP"
data$CUTRESTEMP<-NA
data$CUTRESTEMP<-cut(data$ResTemp,c(0,15,25,40))
variable<-"CUTRESTEMP"
table_observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])+table(data$BestAIC_sec,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,df)
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,df)
data2<-subset(data,hIIp<0.05 & aIIp<0.05)
data1<-subset(data,aIp<0.05)
#because aIII so few are significant.
#so can calc for ai,aii,hii,hiii
data3<-subset(data,hIIIp<0.05 & aIIIp<0.05)
data3h<-subset(data,hIIIp<0.05)
#summary(lm(data$ConTemp~log(data$aI)))
#aI has 3 negative values which is why log is upset
#aII and aIII has NAs because model doesnt fit for all
#sum(is.na(log(data$aIII)))
#sum(is.na(data$aIII))
shapiro.test(na.omit(data$ResTemp))
dataset_aii<-subset(data2, !is.na(ResTemp) & !is.na(aII))
a<-lm(dataset_aii$ConTemp~log(dataset_aii$aII))
shapiro.test(a$residuals)
dataset_aiii<-subset(data3, !is.na(ResTemp) & !is.na(aIII))
a<-lm(dataset_aiii$ConTemp~log(dataset_aiii$aIII))
shapiro.test(a$residuals)
dataset_ai<-subset(data1, !is.na(ResTemp) & aI>0)
a<-lm(dataset_ai$ConTemp~log(dataset_ai$aI))
shapiro.test(a$residuals)
dataset_hiii<-subset(data3h, !is.na(hIII))
dataset_hii<-subset(data2, !is.na(hII))
#so not normally distributed . so lets do non parametric testing
#so best to use spearman
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s")
#spearman not working because of ties in temperature
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "k")
cor.test(dataset_aiii$ConTemp,dataset_aiii$aIII,method = "k")
cor.test(dataset_ai$ConTemp,dataset_ai$aI,method = "k")
cor.test(dataset_hii$ConTemp,dataset_hii$hII,method = "k")
cor.test(dataset_hiii$ConTemp,dataset_hiii$hIII,method = "k")
#now con
shapiro.test(na.omit(data$ConTemp))
dataset_aii<-subset(data2, !is.na(ConTemp)& !is.na(aII))
a<-lm(dataset_aii$ConTemp~log(dataset_aii$aII))
shapiro.test(a$residuals)
dataset_aiii<-subset(data3, !is.na(ConTemp) & !is.na(aIII))
a<-lm(dataset_aiii$ConTemp~log(dataset_aiii$aIII))
shapiro.test(a$residuals)
dataset_ai<-subset(data1,!is.na(ConTemp) &  aI>0)
a<-lm(dataset_ai$ConTemp~log(dataset_ai$aI))
shapiro.test(a$residuals)
dataset_hiii<-subset(data3h, !is.na(ConTemp) & !is.na(hIII))
dataset_hii<-subset(data2, !is.na(ConTemp) &!is.na(hII))
cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "s")
n<-vector(length=4)
con_search_1<-cor.test(dataset_ai$ConTemp,dataset_ai$aI,method = "k")
n[1]<-nrow(dataset_ai)
con_search_2<-cor.test(dataset_aii$ConTemp,dataset_aii$aII,method = "k")
n[2]<-nrow(dataset_aii)
con_search_3<-cor.test(dataset_aiii$ConTemp,dataset_aiii$aIII,method = "k")
#not poss for aiii- only 20 where significant
con_hand_2<-cor.test(dataset_hii$ConTemp,dataset_hii$hII,method = "k")
n[3]<-nrow(dataset_hii)
con_hand_3<-cor.test(dataset_hiii$ConTemp,dataset_hiii$hIII,method = "k")
n[4]<-nrow(dataset_hiii)
testlist<-list(con_search_1,con_search_2,con_hand_2,con_hand_3)
output_temp_con<-matrix(nrow=length(testlist),ncol=4)
colnames(output_temp_con)<-c("z","tau","p-value","n")
rownames(output_temp_con)<-c("Search rate type I","Search rate type II", "Handling time type II", "Handling time type III")
for(i in 1:length(testlist)){
output_temp_con[i,1]<-testlist[[i]]$statistic
output_temp_con[i,2]<-testlist[[i]]$estimate
output_temp_con[i,3]<-testlist[[i]]$p.value
output_temp_con[i,4]<-n[i]
}
#this one a bit different because samplee size
output_temp_con_table<-xtable(output_temp_con,label='Paramtemp',caption = 'Table of results for Kendall rank order correlation tests for consumer temperature and parameter values.')
print(output_temp_con_table,floating=FALSE,tabular.environment = 'longtable',file ="../Results/Tables/output_temp_con_latex.txt",caption.placement ="top")
##section 2 of results
sum(data$BestAIC=="HollingII_AIC")/length(data$BestAIC)
sum(data$BestAIC_sec=="Poly3_AIC")/length(data$BestAIC_sec)
sum(data$BestAIC_sec=="Poly2_AIC")/length(data$BestAIC_sec)
sum(data$best.model.type=="Mechanistic")/length(data$best.model.type)
ggplot(data=data,aes(CUTCONTEMP,BestAIC))+geom_bar()
#caption
write.csv(data,"../Results/dataanalysiscrat.csv")
#working on temp mdel graph
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 20))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 20))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,BestAIC))+geom_bar()
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,BestAIC))+geom_bar(stat="count")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count")
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+
theme_bw()+theme(text = element_text(size = 20))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Best Model Type")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
tempmodel<-ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
printgraph(tempmodel)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
data<-read.csv("../Results/dataanalysiscrat.csv")
data1<-subset(data, aIp<0.05)
data2<-subset(data,hIIp<0.05 & aIIp<0.05)
data1<-subset(data, aIp<0.05)
data2<-subset(data,hIIp<0.05 & aIIp<0.05)
data3a<-subset(data,aIIIp<0.05 )
data3h<-subset(data,hIIIp<0.05)
plot2con<-ggplot()+geom_point(aes(ConTemp,log(aII),color="Search Rate"),data=data2,size=4)+
geom_point(aes(ConTemp,log(hII),color="Handling Time"),data=data2,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot2res<-ggplot()+geom_point(aes(ResTemp,log(aII),color="Search Rate"),data=data2,size=4)+
geom_point(aes(ResTemp,log(hII),color="Handling Time"),data=data2,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot1con<-  ggplot()+geom_point(aes(ConTemp,log(aI),col="Search Rate"),data=data1,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot1res<-ggplot()+
geom_point(aes(ResTemp,log(aI),col="Search Rate"),data=data1,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot3con<-ggplot()+
geom_point(aes(ConTemp,log(aIII),col="Search Rate"),data=data3a,size=4)+
geom_point(aes(ConTemp,log(hIII),col="Handling Time"),data=data3h,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot3res<- ggplot() + geom_point(aes(ResTemp, log(aIII), col = "Search Rate"),size =4,data = data3a) +
geom_point(aes(ResTemp, log(hIII), col = "Handling Time"),size = 4,
data = data3h) +
theme_bw() + scale_color_colorblind("Parameter") + xlab("Temperature (degrees C)") +
ylab("log Parameter") + theme(text = element_text(size = 20))
plot2conA<-ggplot()+geom_point(aes(ConTemp,log(aII)),color=cbbPalette[2],data=data2,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
plot2conH<-ggplot()+geom_point(aes(ConTemp,log(hII)),color=cbbPalette[3],data=data2,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("Handling Time")+theme(text = element_text(size=20))
plot1conA<-ggplot()+geom_point(aes(ConTemp,log(aI)),color=cbbPalette[4],data=data1,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
plot3conH<- ggplot()+geom_point(aes(ConTemp,log(hIII)),color=cbbPalette[5],data=data3h,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("Handling Time")+theme(text = element_text(size=20))
plot3conA<-ggplot()+geom_point(aes(ConTemp,log(aIII)),color=cbbPalette[6],data=data3a,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
plot3con<-ggplot()+
geom_point(aes(ConTemp,log(aIII),col="Search Rate"),data=data3a,size=4)+
geom_point(aes(ConTemp,log(hIII),col="Handling Time"),data=data3h,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot3res<- ggplot() + geom_point(aes(ResTemp, log(aIII), col = "Search Rate"),size =4,data = data3a) +
geom_point(aes(ResTemp, log(hIII), col = "Handling Time"),size = 4,
data = data3h) +
theme_bw() + scale_color_colorblind("Parameter") + xlab("Temperature (degrees C)") +
ylab("log Parameter") + theme(text = element_text(size = 20))
printgraph<-function(name){
png(paste0("../Results/Plots/",substitute(name),".png"))
print(name)
dev.off()
}
#printgraph(plot1con)
#printgraph(plot2con)
#printgraph(plot3con)
#printgraph(plot1res)
#printgraph(plot2res)
#printgraph(plot3res)
printgraph(plot1conA)
printgraph(plot2conA)
printgraph(plot2conH)
printgraph(plot3conA)
printgraph(plot3conH)
par(mfrow=c(3,1))
a<-lm(log(data1$aI)~data1$ConTemp)
##what des this meannnnnnnnn.
plot(data1$ConTemp,log(data1$aI))
plot(data1$ConTemp,sqrt(a$residuals^2))
plot(data1$ConTemp,a$residuals)
#this graph shows that mechanistic is slightly better
modelbesttype<-   ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
modelbesttyperecal<-ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#type 2 most common then 1 then 3
modelbest<-ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,75)+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
modelsecondbest<-ggplot(data=data, aes(BestAIC_sec))+geom_bar()+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
printgraph(modelbesttype)
printgraph(modelbestholl)
printgraph(modelbesthollrecal)
printgraph(modelbest)
printgraph(modelsecondbest)
printgraph(modelbesttyperecal)
#working on temp mdel graph
tempmodel<-ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
printgraph(tempmodel)
