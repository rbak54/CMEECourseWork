source('~/Documents/CMEECourseWork/Miniproject/Code/modelfitting.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/analysistidied.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
source("./modelfittingfunctions.R")
#load data
data<-read.csv("../Data/CRatsort.csv")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
library(ggplot2)
library(ggthemes)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
if (dir.exists("../Results/Plots")==FALSE){
dir.create("../Results/Plots")
}
data<-read.csv("../Results/dataanalysiscrat.csv")
data1<-subset(data, aIp<0.05)
data2<-subset(data,hIIp<0.05 & aIIp<0.05)
data3a<-subset(data,aIIIp<0.05 )
data3h<-subset(data,hIIIp<0.05)
plot2con<-ggplot()+geom_point(aes(ConTemp,log(aII),color="Search Rate"),data=data2,size=4)+
geom_point(aes(ConTemp,log(hII),color="Handling Time"),data=data2,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot2res<-ggplot()+geom_point(aes(ResTemp,log(aII),color="Search Rate"),data=data2,size=4)+
geom_point(aes(ResTemp,log(hII),color="Handling Time"),data=data2,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot1con<-  ggplot()+geom_point(aes(ConTemp,log(aI),col="Search Rate"),data=data1,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot1res<-ggplot()+
geom_point(aes(ResTemp,log(aI),col="Search Rate"),data=data1,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
#not so good for aIII-a worse model
plot3con<-ggplot()+
geom_point(aes(ConTemp,log(aIII),col="Search Rate"),data=data3a,size=4)+
geom_point(aes(ConTemp,log(hIII),col="Handling Time"),data=data3h,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot3res<- ggplot() + geom_point(aes(ResTemp, log(aIII), col = "Search Rate"),size =4,data = data3a) +
geom_point(aes(ResTemp, log(hIII), col = "Handling Time"),size = 4,
data = data3h) +
theme_bw() + scale_color_colorblind("Parameter") + xlab("Temperature (degrees C)") +
ylab("log Parameter") + theme(text = element_text(size = 20))
###changing these
plot2conA<-ggplot()+geom_point(aes(ConTemp,log(aII)),color=cbbPalette[4],data=data2,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
plot2conH<-ggplot()+geom_point(aes(ConTemp,log(hII)),color=cbbPalette[2],data=data2,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("Handling Time")+theme(text = element_text(size=20))
plot1conA<-ggplot()+geom_point(aes(ConTemp,log(aI)),color=cbbPalette[4],data=data1,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
plot3conH<-ggplot()+geom_point(aes(ConTemp,log(hIII)),color=cbbPalette[2],data=data3h,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("Handling Time")+theme(text = element_text(size=20))
plot3conA<-ggplot()+geom_point(aes(ConTemp,log(aIII)),color=cbbPalette[4],data=data3a,size=4)+
theme_bw()+xlab("Consumer Temperature (degrees C)")+ylab("log Search Rate")+theme(text = element_text(size=20))
#not so good for aIII-a worse model
plot3con<-ggplot()+
geom_point(aes(ConTemp,log(aIII),col="Search Rate"),data=data3a,size=4)+
geom_point(aes(ConTemp,log(hIII),col="Handling Time"),data=data3h,size=4)+
theme_bw()+scale_color_colorblind("Parameter")+xlab("Temperature (degrees C)")+ylab("log Parameter")+theme(text = element_text(size=20))
plot3res<- ggplot() + geom_point(aes(ResTemp, log(aIII), col = "Search Rate"),size =4,data = data3a) +
geom_point(aes(ResTemp, log(hIII), col = "Handling Time"),size = 4,
data = data3h) +
theme_bw() + scale_color_colorblind("Parameter") + xlab("Temperature (degrees C)") +
ylab("log Parameter") + theme(text = element_text(size = 20))
printgraph<-function(name){
png(paste0("../Results/Plots/",substitute(name),".png"))
print(name)
dev.off()
}
#printgraph(plot1con)
#printgraph(plot2con)
#printgraph(plot3con)
#printgraph(plot1res)
#printgraph(plot2res)
#printgraph(plot3res)
printgraph(plot1conA)
printgraph(plot2conA)
printgraph(plot2conH)
printgraph(plot3conA)
printgraph(plot3conH)
par(mfrow=c(3,1))
a<-lm(log(data1$aI)~data1$ConTemp)
##what des this meannnnnnnnn.
plot(data1$ConTemp,log(data1$aI))
plot(data1$ConTemp,sqrt(a$residuals^2))
plot(data1$ConTemp,a$residuals)
#TRASH , ALL TRASH
#this graph shows that mechanistic is slightly better
modelbesttype<-   ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
modelbesttyperecal<-ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#  modelbesttyperecal<-ggplot(data=data,aes(x=best.model.type.recal,fill=BestAICRECAL))+geom_bar(stat="count")+
#   theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,150)+scale_fill_colorblind("Best Model")
#diff between holling and holling recal
modelbestholl<-ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+scale_fill_colorblind()+theme(text = element_text(size = 20))
modelbesthollrecal<-ggplot(data=data, aes(BestAICHolRECAL))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
#type 2 most common then 1 then 3
modelbest<-ggplot(data=data, aes(BestAIC))+geom_bar()+ylim(0,75)+theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model")+ylab("Number of models")
modelsecondbest<-ggplot(data=data, aes(BestAIC_sec))+geom_bar()+theme_bw()+theme(text = element_text(size = 15))+xlab("Second Best Model")+ylab("Number of models")
printgraph(modelbesttype)
printgraph(modelbestholl)
printgraph(modelbesthollrecal)
printgraph(modelbest)
printgraph(modelsecondbest)
printgraph(modelbesttyperecal)
#working on temp mdel graph
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECal)+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL)+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
table_observed<-table(data$BestAICHol,data[,variable])+table(data$BestAICHol_sec,data[,variable])
table_observed<-table(data$BestAICHol,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHol,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,df
)
table_observed<-table(data$BestAIC,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAIC,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
table_observed<-table(data$BestAICHol,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHol,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df
)
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df), 2
1-pchisq(chisquared,df)
#model type
table_observed<-table(data$best.model.typeL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.typeL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
#model type
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
#model type
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.type,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHol))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRecal))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=best.model.type.recal))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,5,10,15,20,25,30,3540))
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,25,30,35,40))
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,25,30,40))
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,25,40))
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,40))
table_observed<-table(data$BestAICHolRECAL,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHolRECAL,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
#model type
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,30,35,40))
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.type,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
#model type
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,30,40))
#model type
data$CUTCONTEMP<-cut(data$ConTemp,c(0,5,10,15,20,25,30,40))
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.type,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
#model type
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,30,40))
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.type,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
#model type
data$CUTCONTEMP<-cut(data$ConTemp,c(0,10,15,20,25,40))
table_observed<-table(data$best.model.type,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$best.model.type,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
chisquared<-sum(((Observed-Expected)^2)/Expected)
Observed
#holrecal
data$CUTCONTEMP<-cut(data$ConTemp,c(0,15,20,40))
table_observed<-table(data$BestAICHol,data[,variable])
table_observed<-rbind(table_observed,colSums(table_observed))
table_observed<-cbind(table_observed,rowSums(table_observed))
Observed<-table(data$BestAICHol,data[,variable])
Expected<-matrix(nrow=nrow(Observed),ncol=ncol(Observed))
for(i in 1:(nrow(table_observed)-1)){
for (j in 1:(ncol(table_observed)-1)){
Expected[i,j]<-(table_observed[nrow(table_observed),j]*table_observed[i,ncol(table_observed)])/table_observed[nrow(table_observed),ncol(table_observed)]
}
}
Expected
df<-(nrow(Expected)-1)*(ncol(Expected)-1)
chisquared<-sum(((Observed-Expected)^2)/Expected)
chisquared
1-pchisq(chisquared,df)
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMP,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
ggplot(data=data,aes(CUTCONTEMP,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
source('~/Documents/CMEECourseWork/Miniproject/Code/analysistidied.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Recalculated Holling Model")
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
#working on temp mdel graph
tempmodelrhol<-ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Recalculated Holling Model")
temppmodeltype<-ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Model")
source('~/Documents/CMEECourseWork/Miniproject/Code/analysistidied.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
write(df,"../Results/Tables/dfholrtemp")
write(df,"../Results/Tables/dftypetemp")
printgraph(tempmodelrhol)
printgraph(temppmodeltype)
#working on temp mdel graph
tempmodelrhol<-ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_colorblind("Best Holling Model")
printgraph(tempmodelrhol)
?scale_fill_colorblind
temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(c("#009E73", "#F0E442"))
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(c("#009E73", "#F0E442"))
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c("#009E73", "#F0E442"))
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual("Best Model",values=c("#009E73", "#F0E442"))
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,1250)+scale_fill_manual(values=cbbPalette[2:6],"Best Model")
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,125)+scale_fill_manual(values=cbbPalette[2:6],"Best Model")
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,125)+scale_fill_manual(values=cbbPalette[3:7],"Best Model")
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,125)+scale_fill_manual(values=cbbPalette[4:8],"Best Model")
#working on temp mdel graph
tempmodelrhol<-ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:3],"Best Holling Model")
#working on temp mdel graph
tempmodelrhol<-ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:3]),"Best Holling Model")
#working on temp mdel graph
tempmodelrhol<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:3]),"Best Holling Model")
#working on temp mdel graph
#tempmodelrhol<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:3]),"Best Holling Model")
#working on temp mdel graph
#tempmodelrhol<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Holling Model")
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual("Best Model",values=c(cbbPalette[5:6]))
#working on temp mdel graph
#tempmodelrhol<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Holling Model")
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual("Best Model",values=c(cbbPalette[5:6]))
#working on temp mdel graph
#tempmodelrhol<-
ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Holling Model")
#temppmodeltype<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual("Best Model",values=c(cbbPalette[5:6]))
#this graph shows that mechanistic is slightly better
#modelbesttype<-
ggplot(data=data,aes(x=best.model.type,fill=BestAIC))+geom_bar(stat="count")+
theme_bw()+theme(text = element_text(size = 15))+xlab("Best Model Type")+ylab("Number of models")+ylim(0,125)+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8]),"Best Model")
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
source('~/Documents/CMEECourseWork/Miniproject/Code/plotting.R', echo=TRUE)
#working on temp mdel graph
tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8],"Best Model")
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8],"Best Model"))
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8],"Best Model"))
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8],"Best Model"))
#working on temp mdel graph
#tempmodel<-
ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8]),"Best Model")
#working on temp mdel graph
tempmodel<-ggplot(data=data,aes(CUTCONTEMPTYPE,fill=BestAIC))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4],cbbPalette[7:8]),"Best Model")
tempmodelrhol<-  ggplot(data=data,aes(CUTCONTEMPHOLLING,fill=BestAICHolRECAL))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual(values=c(cbbPalette[2:4]),"Best Holling Model")
temppmodeltype<-ggplot(data=data,aes(CUTCONTEMPTYPE,fill=best.model.type))+geom_bar(stat="count",position = position_dodge())+theme_bw()+theme(text = element_text(size = 20))+xlab("Temperature Interval (degrees C)")+ylab("Number of models")+scale_fill_manual("Best Model Type",values=c(cbbPalette[5:6]))
#+scale_fill_colorblind("Best Model")
printgraph(tempmodelrhol)
printgraph(temppmodeltype)
printgraph(temppmodel)
printgraph(tempmodel)
#diff between holling and holling recal
#modelbestholl<-
ggplot(data=data, aes(BestAICHol))+xlab("Best Holling Model")+ylab("Number of models")+ylim(0,175)+theme_bw()+geom_bar()+theme(text = element_text(size = 20))
