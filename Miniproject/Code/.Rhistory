library(tidyr)
df %>% separate(data$ConTaxa,
df %>% separate(data$ConTaxa,
c("Gen", "Sp","other")
)
df %>% separate(data$ConTaxa,
c("Gen", "Sp","other")
)
data2 %>% separate(data$ConTaxa,
c("Gen", "Sp","other"))
data %>% separate(ConTaxa,
c("Gen", "Sp","other"))
a<-data %>% separate(ConTaxa,
c("Gen", "Sp","other"))
heada$gen
head(a$gen)
head(a$Gen)
unique(a$Gen)
View(a)
View(a)
subset(a,a$Gen=="Daphnia")
nrow(subset(a,a$Gen=="Daphnia"))
nrow(subset(a,a$Gen=="Sander"))
b<-subset(a,a$Gen=="Sander")
ggplot(data=data,aes(x=BestAIC,fill=as.factor(Res_ForagingMovement)))+geom_bar(stat="count")
ggplot(data=data,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
b<-subset(a,a$Gen=="Notonectar")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
b<-subset(a,a$Gen=="Notonecta")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
b<-subset(a,a$Gen=="Cyclops")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
unique(a$Gen)
mnum<-matrix(ncol=2,nrow=length(c))
c[1]
c<-as.vector(unique(a$Gen)
)
c<-as.vector(unique(a$Gen))
c
c[1]
which(a$Gen[1]==c[1])
which(a$Gen[2]==c[2])
which(a$Gen[3]==c[3])
which(a$Gen[4]==c[4])
a$Gen
a$Gen[3]
c
which(a$Gen==c[4])
length(which(a$Gen==c[4]))
for (p in 1:length(c)){
mnum[p,1]<-c[p]
mnum[p,2]<-length(which(a$Gen==c[p]))
}
p<-1
mnum[p,1]<-c[p]
mnum[p,2]<-length(which(a$Gen==c[p]))
for (p in 1:length(c)){
print(p)
#  mnum[p,1]<-c[p]
# mnum[p,2]<-length(which(a$Gen==c[p]))
}
for (p in 1:length(c)){
mnum[p,1]<-c[p]
# mnum[p,2]<-length(which(a$Gen==c[p]))
}
c[3]
c[87]
mnum[1,2]
mnum[2,1]
length(c)
mnum<-matrix(ncol=2,nrow=length(c))
mnum
for (p in 1:length(c)){
mnum[p,1]<-c[p]
mnum[p,2]<-length(which(a$Gen==c[p]))
}
mnum
sort(mnum)
sort(mnum[,2])
mnum
mnums<-matrix(ncol=2)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnum[q,1]<-c[p]
mnum[q,2]<-length(which(a$Gen==c[p]))
q<-q+1
}}
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnum[q,1]<-c[p]
mnum[q,2]<-length(which(a$Gen==c[p]))
q<-q+1
}
}
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnum[q,1]<-c[p]
#   mnum[q,2]<-length(which(a$Gen==c[p]))
q<-q+1
}
}
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnums[q,1]<-c[p]
mnums[q,2]<-length(which(a$Gen==c[p]))
q<-q+1
}
}
mnuma
c[p]
length(which(a$Gen==c[p]))
mnums[q,2]
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
q<-q+1
}
}
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnuma
mnums
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>2){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>3){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>4){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>5){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
mfrow(par=c(2,2))
par(mfrow=c(2,5))
for( i in 1:nrow(mnums)){
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
}
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
hist(b$best.model.type,fill=as.factor(BestAIC))
hist(b$best.model.type,fill=as.factor(b$BestAIC))
hist(b$best.model.type)
bar(b$best.model.type)
barplot(b$best.model.type)
barplot(b$best.model.type)
barplot(b$best.model.type,b$BestAIC)
par(mfrow=c(2,5))
for( i in 1:nrow(mnums)){
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
pause(3)
}
i=1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
i=i+1
b<-subset(a,a$Gen==mnums[i,1])
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
b
b
b$BestAIC==1
b$BestAIC==2
sum(b$BestAIC==2)
#i=0
b<-matrix(nrow=nrow(mnums),ncol=8)
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
}
sub4b
b
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=8))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
}
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=10))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
}
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=10))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
b[i,9]<-sum(sub4b$best.model.type=="Mechanistic")
b[i,10]<-sum(sub4b$best.model.type=="Phenomenological")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
}
b
b[,3:8]
b[,4:8]
chisq.test(b[,4:8])
chisq.test(b[,4:6])
chisq.test(b[,4:6])
b[,4:6]
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>3){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
par(mfrow=c(2,5))
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=10))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
b[i,9]<-sum(sub4b$best.model.type=="Mechanistic")
b[i,10]<-sum(sub4b$best.model.type=="Phenomenological")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
}
b[,4:8]
chisq.test(b[,4:8])
chisq.test(b[,4:6])
d[,4]
b[,4]
d[,4]<-b[,4]+b[,5]+b[,6]
d<-matrix(nrow=nrow(mnums),ncol=5)
d<-matrix(nrow=nrow(mnums),ncol=5)
d[,c(1:3)]<-b[,c(1:3)]
d
d<-matrix(nrow=nrow(mnums),ncol=5)
d
d[,c(1:3)]
b[,c(1:3)]
d[,c(1:3)]<-b[,c(1:3)]
d[,4]<-b[,4]+b[,5]+b[,6]
b[,4]+b[,5]+b[,6]
d[,4]
d<-matrix(nrow=nrow(mnums),ncol=5)
d
d[,c(1:3)]<-b[,c(1:3)]
d
d[,1:3]<-b[,1:3]
d<-matrix(nrow=nrow(mnums),ncol=3)
d[,1]<-b[,1]
d
d[,2]<-b[,4]+b[,5]+b[,6]
d[,3]<-b[,7]+b[,8]
d
d<-as.data.frame(matrix(nrow=nrow(mnums),ncol=3))
d[,1]<-b[,1]
d[,2]<-b[,4]+b[,5]+b[,6]
d[,3]<-b[,7]+b[,8]
d
b[,4:8]
chisq.test(d[,1:2])
chisq.test(d[,2:3])
chisq.test(b[,4:8])
d
chisq.test(d[,2:3])
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>4){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
par(mfrow=c(2,5))
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=10))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
b[i,9]<-sum(sub4b$best.model.type=="Mechanistic")
b[i,10]<-sum(sub4b$best.model.type=="Phenomenological")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
}
b[,4:8]
chisq.test(b[,4:8])
d<-as.data.frame(matrix(nrow=nrow(mnums),ncol=3))
d[,1]<-b[,1]
d[,2]<-b[,4]+b[,5]+b[,6]
d[,3]<-b[,7]+b[,8]
d
chisq.test(d[,2:3])
mnums<-matrix(ncol=2,nrow=0)
for (p in 1:length(c)){
if (length(which(a$Gen==c[p]))>5){
mnums<-rbind(mnums,c(c[p],length(which(a$Gen==c[p]))))
}
}
mnums
par(mfrow=c(2,5))
#i=0
b<-as.data.frame(matrix(nrow=nrow(mnums),ncol=10))
for( i in 1:nrow(mnums)){
#i=i+1
sub4b<-subset(a,a$Gen==mnums[i,1])
b[i,1]<-mnums[i,1]
b[i,2]<-nrow(sub4b)
b[i,3]<-sum(sub4b$N)
for (j in 1:5){
b[i,j+3]<-sum(sub4b$BestAIC==j)
}
b[i,9]<-sum(sub4b$best.model.type=="Mechanistic")
b[i,10]<-sum(sub4b$best.model.type=="Phenomenological")
ggplot(data=b,aes(x=best.model.type,fill=as.factor(BestAIC)))+geom_bar(stat="count")
}
b[,4:8]
chisq.test(b[,4:8])
d<-as.data.frame(matrix(nrow=nrow(mnums),ncol=3))
d[,1]<-b[,1]
d[,2]<-b[,4]+b[,5]+b[,6]
d[,3]<-b[,7]+b[,8]
d
chisq.test(d[,2:3])
table(data$BestAIC,data$Res_ForagingMovement)
chisq.test(table(data$BestAIC,data$Res_ForagingMovement))
chisq.test(table(data$BestAIC,data$Con_ForagingMovement))
chisq.test(table(data$BestAIC,data$Habitat))
table(data$BestAIC,data$Habitat)
head(data)
chisq.test(table(data$best.model.type,data$Habitat))
chisq.test(table(data$best.model.type,data$Res_ForagingMovement))
chisq.test(table(data$best.model.type,data$Con_ForagingMovement))
table(data$best.model.type,data$Con_ForagingMovement)
table(data$best.model.type,data$Res_ForagingMovement)
chisq.test(table(data$best.model.type,data$Res_ForagingMovement))
chisq.test(table(data$BestAIC,data$Res_ForagingMovement))
chisq.test(table(data$BestAIC,data$Res_ForagingMovement))
chisq.test(table(data$BestAIC,data$Res_ForagingMovement))
table(data$BestAIC,data$Res_ForagingMovement)
View(data)
View(data)
hist(data$BestAIC)
0.2*nrow(data)
##stats to say different
Expected<-rep(0.2*nrow(data),5)
Exp.cov()
Expected
sum(data$BestAIC==1)
table(data$BestAIC)
class(table(data$BestAIC))
table(data$BestAIC)[2]
table(data$BestAIC)[,2]
unname(table(data$BestAIC))
Observed<-unname(table(data$BestAIC))
Observed
sum(Expected)
sum(Observed)
##stats to say different
Expected<-rep(0.2*nrow(data),5)
Observed<-unname(table(data$BestAIC))
(Observed-Expected)^2
((Observed-Expected)^2)/Expected
sum(((Observed-Expected)^2)/Expected)
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,4)
#so reject the null hypothesis that all models are as good as each other
Expected<-rep(0.5*nrow(data),2)
Observed<-unname(table(data$best.model.type))
sum(Expected)
sum(Observed)
Observed
Expected
#so reject the null hypothesis that all models are as good as each other
Expected<-rep(0.5*nrow(data),2)
Observed<-unname(table(data$best.model.type))
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,1)
#phenomenological not significantly better
Expected<-rep((1/3)*nrow(data),3)
Observed<-unname(table(data$BestAICHolRECAL))
#phenomenological not significantly better
Expected<-rep((1/3)*nrow(data),3)
Observed<-unname(table(data$BestAICHolRECAL))
sum(Expected)
sum(Observed)
#phenomenological not significantly better
Expected<-rep((1/3)*nrow(data$BestAICHolRECAL!=NA),3)
#phenomenological not significantly better
Expected<-rep((1/3)*nrow(data$BestAICHolRECAL!=NA),3)
Observed<-unname(table(data$BestAICHolRECAL))
sum(Observed)
sum(Expected)
data$BestAICHolRECAL!=NA
data$BestAICHolRECAL
data$BestAICHolRECAL==1
data$BestAICHolRECAL==NA
data$BestAICHolRECAL=="NA"
data$BestAICHolRECAL==0
is.na(data$BestAICHolRECAL)
!is.na(data$BestAICHolRECAL)
sum(!is.na(data$BestAICHolRECAL))
#phenomenological not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHolRECAL)),3)
Observed<-unname(table(data$BestAICHolRECAL))
Observed
#phenomenological not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHolRECAL)),3)
Observed<-unname(table(data$BestAICHolRECAL))
Expected
Observed
sum(Expected)
sum(Observed)
#phenomenological not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHolRECAL)),3)
Observed<-unname(table(data$BestAICHolRECAL))
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,2)
O
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,2)
chisq.test()
chisquared
chisquared<-sum(((Observed-Expected)^2)/Expected)
pchisq(chisquared,2)
1-pchisq(chisquared,2)
#phenomenological not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHol)),3)
Observed<-unname(table(data$BestAICHol))
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,2)
#phenomenological not significantly better
Expected<-rep((1/3)*sum(!is.na(data$BestAICHolRECAL)),3)
Observed<-unname(table(data$BestAICHolRECAL))
chisquared<-sum(((Observed-Expected)^2)/Expected)
1-pchisq(chisquared,2)
table(data$BestAIC)
table(data$BestAIC,data$Res_ForagingMovement)
unname(table(data$BestAIC,data$Res_ForagingMovement))
sum(unname(table(data$BestAIC,data$Res_ForagingMovement)))
